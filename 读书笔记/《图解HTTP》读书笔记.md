---
title: 《图解HTTP》读书笔记
date: 2017-11-20 16:01
comments: true
layout: post
tags: 读书笔记
categories: 读书笔记
---
# 图解HTTP

## TCP/IP协议族

* TCP/IP协议族按层次分别分为四层
  * 应用层
  * 传输层
  * 网络层
  * 数据链路层

<!--more-->

![TCP/IP通信传输流](http://ozar6ogjb.bkt.clouddn.com/TCPIP%E5%88%86%E5%B1%82.png)

URI, URL, URN

* “A Uniform Resource Identifier (URI) 是一个紧凑的字符串用来标示抽象或物理资源。”
* URL， URN是URI的子集，除了确定一个资源，还提供一种定位该资源的主要访问机制
* 换句通俗易懂的话说：
* URN作用就好像一个人的名字，URL就像一个人的地址。再换句话说：URN确定了东西的身份，URL提供了找到他的方式。

## 状态码的类别

|     | 类别 | 原因短语 |
| :-- | :-- | :-- |
| 1xx | Informational(信息状态码) | 接受的请求正在处理 |
| 2xx | Success(成功状态码) | 请求正常处理完毕 |
| 3xx | Redirection(重定向状态码) | 需要进行附加操作以完成请求 |
| 4xx | Client Error(客户端错误状态码) | 服务器无法处理请求 |
| 5xx | Server Error(服务器错误状态代码) | 服务器处理请求出错 |

最具有代表性的14个状态码：

_**2xx成功**_

* 200 OK
  * 表示从客户端发来的请求在服务器端被正常处理了。
* 204 No Content
  * 代表服务器接受的请求已成功处理，但在返回的响应报文中不含实体的主体部分。
* 206 Partial Content
  * 表示客户端进行了范围请求，而服务器成功执行了这部分的GET请求。

_**3xx重定向**_

当301， 302， 303响应状态码返回时，几乎所有的浏览器都会把POST改成GET，并删除请求报文内的主体，之后请求会自动再次发送。

* 301 Moved Permanently
  * 永久性重定向。
* 302 Found
  * 临时性重定向。
* 303 See Other
  * 由于请求对应的资源存在着另一个URI，应使用GET方法定向获取请求的资源。
* 304 Not Modified
  * 表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但因发生请求为满足条件的情况后，直接返回304 Not Modified（服务器端资源未改变，可直接使用客户端未过期的缓存）。
* 307 Temporary Redirect
  * 临时重定向。该状态码与302有相同的含义，但是307不会从POST变成GET。

_**4xx客户端错误**_

* 400 Bad Request
  * 表示请求报文中存在语法错误。
* 401 Unauthorized
  * 表示发送的请求需要有通过HTTP认证的认证信息。
* 403 Forbidden
  * 表明对请求资源的访问被服务器拒绝了。
* 404 Not Found
  * 表明服务器上没有请求的资源。

_**5xx服务器错误**_

* 500 Internal Server Error
  * 表明服务器在执行请求时发生了错误。
* 503 Service Unavailbale
  * 表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。

## 通信数据转发程序：代理、网关、隧道

### 代理

代理服务器的基本行为就是接收客户端发送的请求后转发给其他服务器。**代理不改变请求URI**，会直接发送给前方持有资源的目标服务器。

持有资源实体的服务器称为**源服务器**，从源服务器返回的响应经过代理服务器后再传给客户端。

使用代理服务器的理由：

* 利用缓存技术，减少网络带宽的流量。
* 组织内部针对特定网站的访问控制，以获取访问日志为主要目的。

代理有两种基准分类： 一种是是否使用了缓存，另一种是是否会修改报文。

缓存代理：代理转发响应式，**缓存代理**会预先将资源的副本保存在代理服务器上。

透明代理：转发请求或响应时，不对报文做任何加工的代理类型被称为**透明代理**。反之，如果对报文内容进行加工的代理就叫做**非透明代理**。

### 网关

网关能使通信线路上的服务器提供非HTTP协议服务。

利用网关能提高通信的安全性。

比如说：网关可以连接数据库。还有在我们淘宝购物用信用卡结账的时候，网关可以和信用卡结算系统联动。

### 隧道

隧道可按要求建立起一条与其他服务器的通信线路，届时使用SSL等加密手段进行通信。

也就是说，隧道本身是不会去解析HTTP请求的，他只是作为一个很安全的通道去让客户端与服务器相连。

## HTTP首部

### HTTP请求报文

在请求中，HTTP报文由方法、URI、HTTP版本、HTTP首部字段等部分构成

### HTTP响应报文

在响应中，HTTP报文由HTTP版本、状态码（数字和原因短语）、HTTP首部字段 3部分构成。

### HTTP首部字段

使用首部字段是为了给浏览器和服务器提供报文主体大小，所使用的语言、认证信息等内容。

HTTP首部字段是由**首部字段名**和**字段值**构成：

> 首部字段名： 字段值

在HTTP首部中，以Content-Type这个字段来表示报文主题的对象类型：
> Content-Type: text/html
>
> 首部字段名：     字段值

而且在字段值对应单个HTTP首部字段可以有多个值。

> Keep-Alive: timeout=15, max=100

### 4种HTTP首部字段类型

* 通用首部字段
  * 请求报文和响应报文两端都会使用的首部
* 请求首部字段
  * 从客户端向服务器端发送请求报文时使用的首部。
    * 补充了请求的附加内容、客户端信息、响应内容相关优化级等信息
* 响应首部字段
  * 从服务器向客户端返回响应报文时使用的首部。
    * 补充了响应的附加内容，也会要求客户端附加额外的内容信息。
* 实体首部字段
  * 针对请求报文和响应豹纹的实体部分使用的首部
    * 补充了资源内容更新时间等与实体有关的信息。

## HTTP的缺点

* 通信使用的明文（不加密），可能会被窃听。
* 不验证通信方的身份，因此有可能遭遇伪装。
* 无法证明报文的完整性，所以有可能已遭篡改。

## HTTP使用的认证方式

* BASIC认证（基本认证）
* DIGEST认证（摘要认证）
* SSL客户端认证
* FormBase认证（基于表单认证）

